create or replace TABLE ALIGN_EXTRACT_MASTER ( EXTRACT_ID NUMBER(5,0) NOT NULL, GROUP_NAME VARCHAR(100) NOT NULL, FILE_NAME VARCHAR(100) NOT NULL, EXTRACT_TYPE VARCHAR(10) NOT NULL, FILE_EXTN VARCHAR(10) NOT NULL, DATE_FORMAT VARCHAR(30), FILE_HEADER VARCHAR(3), FIELD_DELIMITER VARCHAR(255), IMT_QUERY VARCHAR(16777216), EXTRACT_QUERY VARCHAR(16777216) NOT NULL, PREVIOUS_EXTRACT_DATE TIMESTAMP_NTZ(9), CURRENT_EXTRACT_DATE TIMESTAMP_NTZ(9), TGT_FILE_LOCATION VARCHAR(200), EXTRACT_SEQUENCE NUMBER(5,0) NOT NULL, EXTRACT_ACTIVE_FLAG VARCHAR(1) NOT NULL, FILE_FORMAT_NAME VARCHAR(255), OPTIONAL_FIELD_ENCLOSED VARCHAR(255), constraint ALIGN_EXTRACT_MASTER_PKEY primary key (GROUP_NAME, FILE_NAME, EXTRACT_TYPE, FILE_EXTN), constraint SYS_C0074420 unique (EXTRACT_ID) );
 
---CONFIG TABLE --  

---CONFIG TABLE VALUES â€“
insert  into ALIGN_EXTRACT_MASTER(
EXTRACT_ID,

GROUP_NAME,

FILE_NAME,

EXTRACT_TYPE,

FILE_EXTN,

DATE_FORMAT,

FILE_HEADER,

FIELD_DELIMITER,

IMT_QUERY,

EXTRACT_QUERY,

PREVIOUS_EXTRACT_DATE,

CURRENT_EXTRACT_DATE,

TGT_FILE_LOCATION,

EXTRACT_SEQUENCE,

EXTRACT_ACTIVE_FLAG,

FILE_FORMAT_NAME,

OPTIONAL_FIELD_ENCLOSED,

  --values for each above fields
  values(
24,

'VENETOCLAX_FULL',

'SF_ABBVIE_ROSTER',

'FULL',

'dat',

'YYYYMMDD_HHMI',

'N',

'|',

'SELECT  TERRITORY_TYPE_ID, OVERLAY, TERRITORY_NO, EMP_NUM, SALES_FORCE_IT, SALES_FORCE_BUSS, SF_DESCRIPTION, FRANCHISE, FIRST_NAME, LAST_NAME, MIDDLE_NAME, CELL_PHONE, FCL_ADDR1, FCL_ADDR2, FCL_CITY, FCL_STATE, FCL_ZIP, UPI, EMAIL, DM_TERRITORY_NO, DM_FIRST_NAME, DM_LAST_NAME, DM_MIDDLE_NAME, DM_EMP_NUM, DM_UPI, DM_EMAIL, RM_TERRITORY_NO, RM_FIRST_NAME, RM_LAST_NAME, RM_MIDDLE_INITIAL, RM_EMP_NUM, RM_UPI, RM_EMAIL, SAMPLE_SHIP_IND, SAMPLE_MGNT_IND, DM_CELL_PHONE, RM_CELL_PHONE FROM ALIGN.ALIGN_EXTRACT_VENETOCLAX_V  where  coalesce(UPI,99)  not IN (SELECT sys1_value1 FROM ALIGN.odscl_sfa_sys_parameter WHERE PARAMETER_NAME='UPI_FILTER' AND sys1_field1 = 'UPI_ID' AND ACTIVE_FLG = 'Y' )',

'Align_Extracts',

'1',

'Y',

'"'),


